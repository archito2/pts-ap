<core:FragmentDefinition 
    xmlns="sap.m" 
    xmlns:l="sap.ui.layout" 
    xmlns:f="sap.ui.layout.form" 
    xmlns:core="sap.ui.core" 
    xmlns:app="http://schemas.sap.com/sapui5/extension/sap.ui.core.CustomData/1">
    <Table selectionChange="handleSelectionChange" mode="SingleSelectMaster" id="idItemsTable" inset="false" items="{ path: 'viewModel>/Items'}">
        <headerToolbar>
            <Toolbar>
                <Title text="Items" level="H2"/>
                <ToolbarSpacer/>
                <Button text="Add" icon="sap-icon://add" press="handleAddItem"/>
                <Button enabled = "{configModel>/rowSelected}" text="Copy" icon="sap-icon://copy" press="handleCopyItem"/>
                <Button enabled = "{configModel>/rowSelected}" text="Delete" icon="sap-icon://delete" press="handleDeleteItem"/>
                <Button text="Credit Card Lines" icon="sap-icon://credit-card" press="handleCClines"/>
                <Button text="Apply Template" icon="sap-icon://crm-service-manager" press="handleApplyTemplate"/>
            </Toolbar>
        </headerToolbar>
        <columns>
            <Column>
                <Text text="Expense Type"/>
            </Column>
            <Column width="5%"/>
            <Column visible = "{=${viewModel>/WebStatus/WEB_ER_HIDE_EXP_AMOUNTT}!=='X'}">
                <Text text="Amount"/>
            </Column>
            <Column visible = "{=${viewModel>/WebStatus/WEB_ER_HIDE_EXP_CURRENCYT}!=='X'}">
                <Text text="Currency"/>
            </Column>
            <Column visible = "{=${viewModel>/WebStatus/WEB_ER_HIDE_EXP_LAND1}!=='X'}">
                <Text text="Country"/>
            </Column>
            <Column visible = "{=${viewModel>/WebStatus/WEB_ER_HIDE_EXP_DATE1}!=='X'}">
                <Text text="Expense Date"/>
            </Column>
            <Column visible = "{=${viewModel>/WebStatus/WEB_ER_HIDE_NETWRT}!=='X'}">
                <Text text="Converted Amount"/>
            </Column>
            <Column visible = "{=${viewModel>/WebStatus/WEB_ER_HIDE_GLACCT}!=='X'&amp;&amp;
                ${viewModel>/WebStatus/WEB_ER_SHOW_GLFLD}==='X'}">
                <Text text="G/L"/>
            </Column>
            <Column visible = "{=${viewModel>/WebStatus/WEB_ER_HIDE_KOSTLT}!=='X'}">
                <Text text="Cost Center"/>
            </Column>
            <Column visible = "{=${viewModel>/WebStatus/WEB_ER_HIDE_CRG_TYPET}!=='X'}">
                <Text text="Payment Method"/>
            </Column>
            <Column visible = "{=${viewModel>/WebStatus/WEB_ER_HIDE_AUFNRT}!=='X'&amp;&amp;
                ${viewModel>/WebStatus/WEB_ER_SHOW_GLFLD}==='X'}">
                <Text text="Order"/>
            </Column>
            <Column visible = "{=${viewModel>/WebStatus/WEB_ER_HIDE_PRCTRT}!=='X'&amp;&amp;
                ${viewModel>/WebStatus/WEB_ER_SHOW_GLFLD}==='X'}">
                <Text text="Profit Center"/>
            </Column>
            <Column visible = "{=${viewModel>/WebStatus/WEB_ER_HIDE_PPRCTT}!=='X'&amp;&amp;
                ${viewModel>/WebStatus/WEB_ER_SHOW_GLFLD}==='X'}">
                <Text text="Partner Profit Center"/>
            </Column>
            <Column visible = "{=${viewModel>/WebStatus/WEB_ER_HIDE_PROJKT}!=='X'&amp;&amp;
                ${viewModel>/WebStatus/WEB_ER_SHOW_GLFLD}==='X'}">
                <Text text="WBS Element"/>
            </Column>
            <Column visible = "{=${viewModel>/WebStatus/WEB_ER_HIDE_FKBERT}!=='X'&amp;&amp;
                ${viewModel>/WebStatus/WEB_ER_SHOW_GLFLD}==='X'}">
                <Text text="Functional Area"/>
            </Column>
            <Column visible = "{=${viewModel>/WebStatus/WEB_ER_HIDE_BUKRST}!=='X'&amp;&amp;
                ${viewModel>/WebStatus/WEB_ER_SHOW_GLFLD}==='X'}">
                <Text text="Company Code"/>
            </Column>
            <Column visible = "{=${viewModel>/WebStatus/WEB_ER_HIDE_SGTXTT}!=='X'}">
                <Text text="Line Item Text"/>
            </Column>
            <Column visible = "{=${viewModel>/WebStatus/WEB_ER_HIDE_FISTLT}!=='X'&amp;&amp;
                ${viewModel>/WebStatus/WEB_ER_SHOW_GLFLD}==='X'}">
                <Text text="Funds Center"/>
            </Column>
            <Column visible = "{=${viewModel>/WebStatus/WEB_ER_HIDE_GEBERT}!=='X'&amp;&amp;
                ${viewModel>/WebStatus/WEB_ER_SHOW_GLFLD}==='X'}">
                <Text text="Fund"/>
            </Column>
            <Column visible = "{=
                ${viewModel>/WebStatus/WEB_ER_HIDE_XREF1T}!=='X'
                    &amp;&amp;
                ${viewModel>/WebStatus/WEB_ER_SHOW_GLFLD}==='X'}">
                <Text text="Building Unit"/>
            </Column>
            <Column visible = "{=${viewModel>/WebStatus/WEB_ER_HIDE_XREF2T}!=='X'
            &amp;&amp;
                ${viewModel>/WebStatus/WEB_ER_SHOW_GLFLD}==='X'}">
                <Text text="Work Order"/>
            </Column>
            <Column visible = "{=${viewModel>/WebStatus/WEB_ER_HIDE_VATT}!=='X'}">
                <Text text="VAT"/>
            </Column>
            <Column visible = "{=${viewModel>/WebStatus/WEB_ER_HIDE_OFDOCUMENTIDT}!=='X'}">
                <Text text="CC ID"/>
            </Column>
        </columns>
        <items>
            <ColumnListItem vAlign="Middle">
                <cells>
                    <!-- Expense Type -->
                    <VBox>
                        <Text 
                            visible="{=!${viewModel>/UIModel/CreateMode}}" text="{path : 'viewModel>Spkzl',formatter : '._getSpkzlName'}"/>
                        <Select change="handleExpTypeChange"
                            visible="{=${viewModel>/UIModel/CreateMode}}" forceSelection="true" selectedKey="{viewModel>Spkzl}" 
                            items="{path: 'viewModel>/ExpenseTypeSet/results',templateShareable : false}">
                            <core:Item key="{viewModel>ExpType}" text="{viewModel>NameOfExpType}" />
                        </Select>
                    </VBox>
                    <!-- Detail -->
                    <Button 
                        enabled = "{path : 'viewModel>Spkzl',formatter : '._isDetailVisible'}" type="{path : 'viewModel>Spkzl',formatter : '._buttonType'}" icon="sap-icon://action" press ="handleDetailPress"/>
                    <!-- Amount -->
                    <VBox>
                        <Text visible="{=!${viewModel>/UIModel/CreateMode}}" text="{viewModel>ExpAmount}"/>
                        <Input placeholder= "Amount" visible="{=${viewModel>/UIModel/CreateMode}}" value="{
                            parts:[
                                {path :'viewModel>ExpAmount'},
                                {path:'viewModel>ExpCurrency'}
                            ],
                            type:'sap.ui.model.type.Currency',
                            formatOptions: {showMeasure: false}
                        }"/>
                    </VBox>
                    <!-- Currency -->
                    <VBox>
                        <Text visible="{=!${viewModel>/UIModel/CreateMode}}" text="{viewModel>ExpCurrency}"/>
                        <Input placeholder= "Currency" visible="{=${viewModel>/UIModel/CreateMode}}" value="{viewModel>ExpCurrency}" showSuggestion="true" suggestionItems="{currencyModel>/currencies}">
                            <suggestionItems>
                                <core:Item text="{currencyModel>value}" />
                            </suggestionItems>
                        </Input>
                    </VBox>
                    <!-- Country -->
                    <VBox>
                        <Text visible="{=!${viewModel>/UIModel/CreateMode}}" text="{viewModel>ExpLand1}"/>
                        <!-- <Input placeholder= "Country" visible="{=${viewModel>/UIModel/CreateMode}}" value="{viewModel>ExpLand1}"/> -->
                        <ComboBox showSecondaryValues= "true" filterSecondaryValues= "true" value="{viewModel>ExpLand1}" selectedKey="{viewModel>ExpLand1}" items="{path: 'countryModel>/Countries'}">
                            <core:ListItem key="{countryModel>code}" text="{countryModel>country}" additionalText="{countryModel>code}"/>
                        </ComboBox>
                    </VBox>
                    <!-- Expense Date -->
                    <VBox>
                        <Text visible="{=!${viewModel>/UIModel/CreateMode}}" text="{viewModel>ExpDate}"/>
                        <DatePicker placeholder= "Date" visible="{=${viewModel>/UIModel/CreateMode}}" dateValue="{viewModel>ExpDate}"/>
                    </VBox>
                    <!-- Converted Amount -->
                    <VBox>
                        <Text visible="{=!${viewModel>/UIModel/CreateMode}}" text="{viewModel>Netwr}"/>
                        <Input editable="false" placeholder= "Amount" visible="{=${viewModel>/UIModel/CreateMode}}" value="{viewModel>Netwr}"/>
                    </VBox>
                    <!-- Glacc -->
                    <VBox>
                        <Text visible="{=!${viewModel>/UIModel/CreateMode}}" text="{path :'viewModel>Glacc',formatter:'._removeLeadingZeroes'}"/>
                        <Input placeholder= "Glacc" visible="{=${viewModel>/UIModel/CreateMode}}" value="{viewModel>Glacc}"/>
                        <Text visible="{=!${viewModel>/UIModel/CreateMode}}" text="{viewModel>Gltxt}"/>
                    </VBox>
                    <VBox>
                        <Text visible="{=!${viewModel>/UIModel/CreateMode}}" text="{path :'viewModel>Kostl',formatter:'._removeLeadingZeroes'}"/>
                        <Input placeholder= "Cost Center" visible="{=${viewModel>/UIModel/CreateMode}}" value="{viewModel>Kostl}"/>
                        <Text visible="{=!${viewModel>/UIModel/CreateMode}}" text="{viewModel>Kostltxt}"/>
                    </VBox>
                    <VBox>
                        <Text visible="{=!${viewModel>/UIModel/CreateMode}}" text="{viewModel>CrgType}"/>
                        <!-- <Input editable="false" placeholder= "Crgtype" visible="{=${viewModel>/UIModel/CreateMode}}" value="{viewModel>CrgType}"/> -->
                        <Select 
                            enabled= "false" visible="{=${viewModel>/UIModel/CreateMode}}" forceSelection="true" selectedKey="{viewModel>CrgType}" 
                            items="{paymentMethodModel>/methods}" ediatble="false">
                            <core:Item key="{paymentMethodModel>key}" text="{paymentMethodModel>value}" />
                        </Select>
                    </VBox>
                    <VBox>
                        <Text visible="{=!${viewModel>/UIModel/CreateMode}}" text="{viewModel>Aufnr}"/>
                        <Input placeholder= "Order" visible="{=${viewModel>/UIModel/CreateMode}}" value="{viewModel>Aufnr}"/>
                    </VBox>
                    <VBox>
                        <Text visible="{=!${viewModel>/UIModel/CreateMode}}" text="{viewModel>Prctr}"/>
                        <Input placeholder= "Profit Center" visible="{=${viewModel>/UIModel/CreateMode}}" value="{viewModel>Prctr}"/>
                    </VBox>
                    <VBox>
                        <Text visible="{=!${viewModel>/UIModel/CreateMode}}" text="{viewModel>Pprct}"/>
                        <Input placeholder= "Partner Profit Center" visible="{=${viewModel>/UIModel/CreateMode}}" value="{viewModel>Pprct}"/>
                    </VBox>
                    <VBox>
                        <Text visible="{=!${viewModel>/UIModel/CreateMode}}" text="{viewModel>Projk}"/>
                        <Input visible="{=${viewModel>/UIModel/CreateMode}}" value="{viewModel>Projk}"/>
                    </VBox>
                    <VBox>
                        <Text visible="{=!${viewModel>/UIModel/CreateMode}}" text="{viewModel>Fkber}"/>
                        <Input visible="{=${viewModel>/UIModel/CreateMode}}" value="{viewModel>Fkber}"/>
                    </VBox>
                    <VBox>
                        <Text visible="{=!${viewModel>/UIModel/CreateMode}}" text="{viewModel>Bukrs}"/>
                        <Input visible="{=${viewModel>/UIModel/CreateMode}}" value="{viewModel>Bukrs}"/>
                    </VBox>
                    <VBox>
                        <Text visible="{=!${viewModel>/UIModel/CreateMode}}" text="{viewModel>Sgtxt}"/>
                        <Input visible="{=${viewModel>/UIModel/CreateMode}}" value="{viewModel>Sgtxt}"/>
                    </VBox>
                    <VBox>
                        <Text visible="{=!${viewModel>/UIModel/CreateMode}}" text="{viewModel>Fistl}"/>
                        <Input visible="{=${viewModel>/UIModel/CreateMode}}" value="{viewModel>Fistl}"/>
                    </VBox>
                    <VBox>
                        <Text visible="{=!${viewModel>/UIModel/CreateMode}}" text="{viewModel>Geber}"/>
                        <Input visible="{=${viewModel>/UIModel/CreateMode}}" value="{viewModel>Geber}"/>
                    </VBox>
                    <VBox>
                        <Text visible="{=!${viewModel>/UIModel/CreateMode}}" text="{viewModel>Xref1}"/>
                        <Input visible="{=${viewModel>/UIModel/CreateMode}}" value="{viewModel>Xref1}"/>
                    </VBox>
                    <VBox>
                        <Text visible="{=!${viewModel>/UIModel/CreateMode}}" text="{viewModel>Xref2}"/>
                        <Input visible="{=${viewModel>/UIModel/CreateMode}}" value="{viewModel>Xref2}"/>
                    </VBox>
                    <VBox>
                        <Text visible="{=!${viewModel>/UIModel/CreateMode}}" text="{viewModel>Vat}"/>
                        <Input visible="{=${viewModel>/UIModel/CreateMode}}" value="{viewModel>Vat}"/>
                    </VBox>
                    <VBox>
                        <Text visible="{=!${viewModel>/UIModel/CreateMode}}" text="{viewModel>Ofdocumentid}"/>
                        <Input visible="{=${viewModel>/UIModel/CreateMode}}" value="{viewModel>Ofdocumentid}"/>
                    </VBox>
                </cells>
            </ColumnListItem>
        </items>
    </Table>
</core:FragmentDefinition>